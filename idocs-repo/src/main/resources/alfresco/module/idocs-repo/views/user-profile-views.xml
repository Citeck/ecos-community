<?xml version="1.0" encoding="UTF-8"?>
<views xmlns="http://www.citeck.ru/ecos/views/1.0">
    <imports>
        <import uri="http://www.alfresco.org/model/dictionary/1.0" prefix="d" />
        <import uri="http://www.alfresco.org/model/content/1.0" prefix="cm" />
        <import uri="http://www.citeck.ru/model/deputy/1.0" prefix="deputy" />
        <import uri="http://www.citeck.ru/model/orgstruct/1.0" prefix="org" />
        <import uri="http://www.citeck.ru/model/content/idocs/1.0" prefix="idocs" />
        <import uri="http://www.citeck.ru/model/content/ecos/1.0" prefix="ecos" />
    </imports>

    <view class="cm:person" kind="2-column">
        <param name="inlineEdit">false</param>
        <param name="invariantsRuntimeCache">false</param>
        <param name="preloadInvariants">true</param>

        <view id="person-go-to-edit-mode" template="person-edit-btn">
            <param name="preloadInvariants">true</param>
        </view>

        <view id="cm_person_general_info">
            <param name="preloadInvariants">true</param>
            <param name="title">Основное</param>
            <param name="invariantsRuntimeCache">false</param>
            <field prop="cm:userName" id="user-name">
                <invariant on="protected" language="explicit">true</invariant>
            </field>

            <view id="cm_person_general_info_ecos_photo">
                <field prop="ecos:photo">
                    <region name="input" template="img">
                        <param name="width">250</param>
                        <!--<param name="height">250</param>-->
                        <param name="alt">This is user's photo</param>
                    </region>
                </field>
            </view>

            <field prop="cm:firstName"/>
            <field prop="cm:lastName"/>
            <field prop="cm:middleName"/>
            <field prop="idocs:nameInGenitiveCase"/>
            <field prop="ecos:birthDate"/>
            <field prop="ecos:sex">
                <region name="input" template="select"/>
            </field>
            <field prop="ecos:city"/>
            <field prop="cm:organization"/>
            <field prop="cm:jobtitle"/>
        </view>

        <view id="cm_person_phones">
            <param name="preloadInvariants">true</param>
            <param name="title">Телефоны</param>
            <field prop="ecos:phoneWorking" />
            <field prop="ecos:phoneInternal" />
            <field prop="cm:mobile" id="mob-123">
                <region name="label" template="label">
                    <param name="title">Телефон мобильный</param>
                </region>
            </field>
        </view>

        <view id="cm_person_other_info">
            <param name="preloadInvariants">true</param>
            <param name="title">Прочее</param>
            <field prop="cm:location"/>
            <field prop="cm:skype"/>
            <field prop="cm:email">
                <invariant on="valid" language="javascript">
                    /.+@.+\..+/.test(value)
                </invariant>
            </field>
            <view class="deputy:availability">
                <param name="preloadInvariants">true</param>
                <field prop="deputy:available">
                    <invariant on="mandatory" language="explicit">true</invariant>
                    <invariant on="default" language="explicit">true</invariant>
                </field>
            </view>

            <field prop="cm:userStatus"/>
            <field prop="org:preset"/>

            <field prop="cm:userName" id="user-groups">
                <region name="label" template="label">
                    <param name="key">Группы пользователя</param>
                </region>
                <region name="input" template="user-groups">
                </region>
            </field>
        </view>
    </view>

    <views class="cm:person" mode="view">
        <param name="preloadInvariants">true</param>
        <views class="deputy:availability">
            <param name="preloadInvariants">true</param>
            <fields prop="deputy:available">
                <regions name="input" template="view">
                    <param name="emptyLabel">label.yes</param>
                </regions>
            </fields>
        </views>
    </views>
</views>