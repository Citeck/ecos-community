<?xml version="1.0" encoding="UTF-8"?>
<model name="samwf:samwf" xmlns="http://www.alfresco.org/model/dictionary/1.0">
    <description>Security workflow model</description>
    <author>Citeck</author>
    <version>1.0</version>
    <imports>
        <import uri="http://www.alfresco.org/model/dictionary/1.0" prefix="d" />
        <import uri="http://www.citeck.ru/model/content/idocs/1.0" prefix="idocs"/>
        <import uri="http://www.citeck.ru/model/workflow/case-perform/1.0" prefix="wfcp" />
        <import uri="http://www.alfresco.org/model/content/1.0" prefix="cm" />
        <import uri="http://www.alfresco.org/model/datalist/1.0" prefix="dl"/>
    </imports>

    <namespaces>
        <namespace uri="http://www.citeck.ru/model/samwf/1.0" prefix="samwf"/>
    </namespaces>

    <constraints>
        <constraint name="samwf:percentage" type="MINMAX">
            <parameter name="minValue">
                <value>0</value>
            </parameter>
            <parameter name="maxValue">
                <value>100</value>
            </parameter>
        </constraint>
    </constraints>

    <types>

        <type name="samwf:incomePackageTask">
            <parent>wfcp:performTask</parent>
            <properties>
                <property name="samwf:registrationDate">
                    <title>Registration Date</title>
                    <type>d:date</type>
                </property>
                <property name="samwf:idEdi">
                    <title>ID EDI</title>
                    <type>d:text</type>
                </property>
                <!--<property name="samwf:contractor">-->
                    <!--<title>Contractor</title>-->
                    <!--<type>d:text</type>-->
                <!--</property>-->
                <property name="samwf:signedContractor">
                    <title>Is signed by contractor</title>
                    <type>d:boolean</type>
                </property>
                <property name="samwf:contractorINN">
                    <title>Contractor INN</title>
                    <type>d:text</type>
                </property>
                <property name="samwf:isDeferredTask">
                    <type>d:boolean</type>
                    <default>false</default>
                </property>
                <property name="samwf:processingStatus">
                    <title>Processing status</title>
                    <type>d:text</type>
                    <constraints>
                        <constraint name="samwf:processingStatusOptions" type="LIST">
                            <parameter name="allowedValues">
                                <list>
                                    <value>NOT_PROCESSED</value>
                                    <value>IN_PROGRESS</value>
                                    <value>PARTIALLY_PROCESSED</value>
                                    <value>FULLY_PROCESSED</value>
                                </list>
                            </parameter>
                        </constraint>
                    </constraints>
                </property>
                <!-- Fake field for journal -->
                <property name="samwf:inactivityPeriod">
                    <type>d:int</type>
                </property>
                <property name="samwf:clientBoxId">
                    <title>Client box ID</title>
                    <type>d:text</type>
                    <index enabled="true">
                        <atomic>true</atomic>
                        <stored>false</stored>
                        <tokenised>false</tokenised>
                    </index>
                </property>
            </properties>
            <associations>
                <association name="samwf:contractor">
                    <title>Contractor</title>
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>idocs:abstractContractor</class>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </target>
                </association>
                <association name="samwf:attachments">
                    <title>Attachments</title>
                    <source>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </source>
                    <target>
                        <class>idocs:doc</class>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </target>
                </association>
            </associations>
            <overrides>
                <property name="wfcp:performOutcome">
                    <constraints>
                        <constraint name="samwf:incomePackageOutcomeConstraint" type="LIST">
                            <parameter name="allowedValues">
                                <list>
                                    <value>Done</value>
                                </list>
                            </parameter>
                        </constraint>
                    </constraints>
                </property>
            </overrides>
        </type>

        <type name="samwf:rejectionSignTask">
            <parent>wfcp:performTask</parent>
            <properties>
                <property name="samwf:rejectionSignTaskRegistrationDate">
                    <title>Registration Date</title>
                    <type>d:date</type>
                </property>
                <property name="samwf:rejectionSignTaskIdEdi">
                    <title>ID EDI</title>
                    <type>d:text</type>
                </property>
                <property name="samwf:rejectionSignTaskSignedContractor">
                    <title>Is signed by contractor</title>
                    <type>d:boolean</type>
                </property>
                <property name="samwf:rejectionSignTaskIncomePackageTaskId">
                    <title>Related income package task ID</title>
                    <type>d:text</type>
                </property>
                <property name="samwf:rejectionSignTaskComment">
                    <title>Comment left by task creator</title>
                    <type>d:text</type>
                </property>
            </properties>
            <associations>
                <association name="samwf:rejectionSignTaskDocuments">
                    <title>Documents for rejection signing</title>
                    <source>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </source>
                    <target>
                        <class>idocs:doc</class>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </target>
                </association>
                <association name="samwf:rejectionSignTaskContractor">
                    <title>Contractor</title>
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>cm:content</class>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </target>
                </association>
            </associations>
            <overrides>
                <property name="wfcp:performOutcome">
                    <constraints>
                        <constraint name="samwf:rejectionSignTaskOutcomeConstraint" type="LIST">
                            <parameter name="allowedValues">
                                <list>
                                    <value>Sign</value>
                                </list>
                            </parameter>
                        </constraint>
                    </constraints>
                </property>
            </overrides>
        </type>

        <type name="samwf:abstractCounterparty">
            <title>Abstract Counterparty</title>
            <parent>idocs:abstractContractor</parent>
        </type>

    </types>

    <aspects>
        <aspect name="samwf:attachmentInfo">
            <properties>
                <property name="samwf:diadocType">
                    <title>Diadoc Type</title>
                    <type>d:text</type>
                </property>
                <property name="samwf:caseType">
                    <title>Case type</title>
                    <type>d:text</type>
                </property>
                <property name="samwf:regNumber">
                    <title>Reg Number</title>
                    <type>d:text</type>
                </property>
                <property name="samwf:incomePackageTaskId">
                    <title>Income package taskId</title>
                    <type>d:text</type>
                </property>
                <property name="samwf:rejectionSignTaskId">
                    <title>Rejection sign taskId</title>
                    <type>d:text</type>
                </property>
                <property name="samwf:rejectionStamp">
                    <title>Timestamp of rejection</title>
                    <type>d:text</type>
                </property>
            </properties>
        </aspect>
    </aspects>

</model>