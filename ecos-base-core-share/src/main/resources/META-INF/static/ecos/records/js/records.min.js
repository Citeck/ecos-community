define(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/",r(r.s=827)}({131:function(t,e,r){"use strict";var n,i=r(2),o=r(4),u="/share/proxy/alfresco/citeck/ecos/records/query";function a(t){if("."===t[0])return t;if(!t)return null;var e,r,n=t,i="#"===t[0];i&&(n=n.substring(1));var o=n.indexOf("?");if(o>=0)e=n.substring(0,o),r=n.substring(o+1);else{if(i)throw new Error("Incorrect attribute: '"+t+"'. Missing ?...");e=n,r="disp"}return"."+(i?"edge":"att")+'(n:"'+e+'"){'+r+"}"}var s=function(){function t(){Object(i.a)(this,t),this._records={}}return Object(o.a)(t,[{key:"get",value:function(t){if(t.indexOf("@")===t.length-1)return new f(t);var e=this._records[t];return e||(e=new f(t),this._records[t]=e),e}},{key:"query",value:function(t){var e=this,r={};if(t.attributes)for(var n in t.attributes)t.attributes.hasOwnProperty(n)&&(r[n]=t.attributes[n]);return new Promise(function(n,i){fetch(u,{method:"POST",credentials:"include",headers:{"Content-type":"application/json;charset=UTF-8"},body:JSON.stringify(t)}).then(function(t){return t.json()}).then(function(t){var i=[];for(var o in t.records)if(t.records.hasOwnProperty(o)){var u=t.records[o];if(u.id){var a=e.get(u.id);for(var s in u.attributes)u.attributes.hasOwnProperty(s)&&a.att(r[s],u.attributes[s])}i.push(u)}n({records:i,hasMore:t.hasMore,totalCount:t.totalCount})})})}}]),t}(),c=function(){function t(e,r,n){Object(i.a)(this,t),this._owner=e,this._name=r,this._persisted=n,this._value=n}return Object(o.a)(t,[{key:"getValue",value:function(){return this.value}},{key:"setValue",value:function(t){this.value=t}},{key:"getName",value:function(){return this._name}},{key:"isPersisted",value:function(){return this._value===this.persisted}},{key:"persisted",get:function(){return this._persisted}},{key:"value",set:function(t){this._value=t},get:function(){return null!=this._value?this._value:this.persisted}}]),t}(),f=function(){function t(e){Object(i.a)(this,t),this._id=e,this._attributes={}}return Object(o.a)(t,[{key:"load",value:function(t,e){var r=this,n=[],i={},o={};for(var s in t)if(t.hasOwnProperty(s)){var f=a(t[s]);if(e)n.push(f),i[f]=s;else{var l=r._attributes[f];l?o[s]=l.value:(n.push(f),i[f]=s)}}return 0===n.length?Promise.resolve(o):new Promise(function(t,e){fetch(u,{method:"POST",credentials:"include",headers:{"Content-type":"application/json;charset=UTF-8"},body:JSON.stringify({record:r.id,attributes:n})}).then(function(t){return t.json()}).then(function(e){var n=e.attributes||{};for(var u in n)n.hasOwnProperty(u)&&(o[i[u]]=n[u],r._attributes[u]=new c(r,u,n[u]));t(o)})})}},{key:"loadAttribute",value:function(t){var e=this;return new Promise(function(r,n){e.load({a:t}).then(function(t){r(t.a)}).catch(function(t){console.error(t),n(t)})})}},{key:"loadEditorKey",value:function(t){return t?this.loadAttribute("#"+t+"?editorKey"):Promise.resolve(null)}},{key:"loadOptions",value:function(t){return t?this.loadAttribute("#"+t+"?options"):Promise.resolve(null)}},{key:"save",value:function(){var t=this,e={},r=!1;for(var n in t._attributes)if(t._attributes.hasOwnProperty(n)){var i=t._attributes[n];i.isPersisted()||(e[n]=i.value,r=!0)}return new Promise(function(n,i){r?fetch("/share/proxy/alfresco/citeck/ecos/records/mutate",{method:"POST",credentials:"include",headers:{"Content-type":"application/json;charset=UTF-8"},body:JSON.stringify({record:{id:t.id,attributes:e}})}).then(function(t){return t.json()}).then(function(r){var i={};for(var o in e)e.hasOwnProperty(o)&&(i[o]=o);t.load(i,!0).then(function(){n(t)})}):n(t)})}},{key:"att",value:function(t,e){if(t){if(!(arguments.length>1))return(this._attributes[t]||{}).value;var r=this._attributes[t];r||(r=new c(null),this._attributes[t]=r),r.value=e}}},{key:"id",get:function(){return this._id}}],[{key:"id",set:function(t){throw new Error("id is a constant field!")}}]),t}();window.Citeck||(window.Citeck={}),window.Citeck=window.Citeck||{},n=window.Citeck.Records||new s,window.Citeck.Records=n,e.a=n},144:function(t,e,r){"use strict";var n=r(131);r.d(e,"a",function(){return n.a})},2:function(t,e,r){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}r.d(e,"a",function(){return n})},4:function(t,e,r){"use strict";function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}r.d(e,"a",function(){return i})},827:function(t,e,r){"use strict";r.r(e);var n=r(144);e.default=n.a}})});
//# sourceMappingURL=records.min.js.map