<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN 2.0//EN" "http://www.springframework.org/dtd/spring-beans-2.0.dtd">
<beans>

    <bean id="ecos.formio.contentDAO" class="ru.citeck.ecos.content.dao.JsonContentDAO">
        <property name="contentType" value="ru.citeck.ecos.formio.model.FormioFormModel" />
    </bean>

    <bean id="ecos.formio.repoFormsDAO" class="ru.citeck.ecos.content.RepoContentDAOImpl">
        <property name="rootNode" value="/${spaces.company_home.childname}/${spaces.dictionary.childname}/cm:formio-forms" />
        <property name="contentDAO" ref="ecos.formio.contentDAO" />
        <property name="configNodeType" value="{http://www.citeck.ru/model/ecos/formio/1.0}form" />
        <property name="nodeDataReader" ref="ecos.formio.formioFormNodeDataReader" />
    </bean>

    <bean id="ecos.formio.contentDeployer" class="ru.citeck.ecos.content.deploy.ContentDeployer">
        <property name="artifactType" value="formio-content-deployer" />
        <property name="repoContentDAO" ref="ecos.formio.repoFormsDAO" />
        <property name="metadataKeys">
            <set>
                <value>{http://www.citeck.ru/model/ecos/content/1.0}id</value>
            </set>
        </property>
        <property name="metadataExtractor">
            <bean class="ru.citeck.ecos.formio.repo.FormioFormMetadata" />
        </property>
        <property name="locations">
            <bean factory-bean="resourceResolver" factory-method="getResources">
                <constructor-arg>
                    <list>
                        <value>classpath*:alfresco/formio/**/*.json</value>
                        <value>classpath*:alfresco/module/*/formio/**/*.json</value>
                        <value>classpath*:alfresco/extension/formio/**/*.json</value>
                    </list>
                </constructor-arg>
            </bean>
        </property>
    </bean>

    <bean id="ecos.formio.repoFormProvider" class="ru.citeck.ecos.formio.provider.RepoFormProvider">
        <property name="formsContentDAO" ref="ecos.formio.repoFormsDAO" />
    </bean>

    <bean id="ecos.formio.formioFormService" class="ru.citeck.ecos.formio.FormioFormServiceImpl" />

    <bean id="ecos.formio.formioFormNodeDataReader" class="ru.citeck.ecos.formio.repo.FormioFormNodeDataReader" />

    <bean class="ru.citeck.ecos.records.source.alfnode.AlfNodesDefaultParentRegistrar">
        <property name="defaultParents">
            <map>
                <entry key="{http://www.citeck.ru/model/ecos/formio/1.0}form" value="/${spaces.company_home.childname}/${spaces.dictionary.childname}/cm:formio-forms" />
            </map>
        </property>
    </bean>

</beans>