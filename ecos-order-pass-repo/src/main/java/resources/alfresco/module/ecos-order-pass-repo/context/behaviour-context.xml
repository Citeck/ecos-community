<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE beans PUBLIC '-//SPRING/DTD BEAN//EN' 'http://www.springframework.org/dtd/spring-beans.dtd'>
<beans>
    <!--<bean id="attorneys.attorneyForm.EnumerationBiehaviour" parent="EnumerationBehaviour"-->
          <!--depends-on="idocs.dictionaryBootstrap">-->
        <!--<property name="className" value="att:attorneyForm"/>-->
        <!--<property name="numberField" value="att:number"/>-->
        <!--<property name="enumerationStateField" value="att:status"/>-->
        <!--<property name="enabledState" value="new"/>-->
        <!--<property name="templateName" value="idocs-attorney-number-template"/>-->
    <!--</bean>-->

    <!--<bean id="attorneys.attorneyForm.fillUtilityNumberField" parent="fillUtilityNumberField">-->
        <!--<property name="className" value="att:attorneyForm"/>-->
        <!--<property name="stringField" value="att:number"/>-->
        <!--<property name="numericField" value="att:numberSort"/>-->
    <!--</bean>-->

	<bean id="attorneys.AttorneyFormCreateBehaviour" init-method="init" 
			class="ru.citeck.alfresco.acm.behavior.attorney.AttorneyFormCreateBehaviour" >
		<property name="isEnabled" value="true"/>
		<property name="policyComponent" ref="policyComponent"/>
		<property name="serviceRegistry" ref="ServiceRegistry"/>
		<property name="canRequestOtherAttorneys">
			<set>
				<value>GROUP_canRequestOtherAttorneys</value>
			</set>
		</property>
		<property name="attorneyRoot" value="${attorneys.attorneys-root-path}" />
	</bean>

	<bean id="attorneys.attorneyForm.NamingBehaviour" parent="AutoNameBehaviour">
		<property name="className" value="att:attorneyForm" />
		<property name="nameTemplate">
			<value><![CDATA[<#if node.properties['idocs:registrationNumber']??>Доверенность № #{'$'}{node.properties['idocs:registrationNumber']}<#if node.properties['att:number']??>, #{'$'}{node.properties['att:number']}</#if><#else>Заявка на доверенность № #{'$'}{node.properties['att:number']!}</#if><#if node.assocs['att:organization']??> #{'$'}{node.assocs['att:organization'][0].name}</#if>]]></value>
		</property>
	</bean>

	<bean id="attorneys.attorneys.NamingBehaviour" parent="AutoNameBehaviour">
		<property name="className" value="attdl:attorneys" />
		<property name="nameTemplate">
			<value><![CDATA[<#list (node.assocs["attdl:attorneyPerson"]![]) as attorney><#assign 
				ln=(attorney.properties["cm:lastName"]!) 
				fn=(attorney.properties["cm:firstName"]!)
				mn=(attorney.properties["cm:middleName"]!)
				un=(attorney.properties["cm:userName"]) /><#if ln != ''>#{'$'}{ln} #{'$'}{fn} #{'$'}{mn}<#elseif fn != ''>#{'$'}{fn} #{'$'}{mn} (#{'$'}{un})<#else>#{'$'}{un}</#if><#if attorney_has_next>, </#if></#list> (<#if (node.properties['attdl:isDraft']!false) == true>Не утверждён<#else>#{'$'}{node.properties['attdl:registryIndividualNumber']}</#if>)]]></value>
		</property>
	</bean>

    <bean id="attorneys.privilege.NamingBehaviour" parent="AutoNameBehaviour">
        <property name="className" value="attdl:privilege" />
        <property name="nameTemplate">
            <value><![CDATA[#{'$'}{node.properties["attdl:privilegeShortName"]!" "}]]></value>
        </property>
    </bean>

	<bean id="attorneys.AddCurrentUserToAttorneyFormBehaviour" parent="idocs.AddCurrentUserToObjectBehaviour">
		<property name="className" value="att:attorneyForm" />
		<property name="targetAssociationOrProperty" value="att:initiator" />
		<property name="whenCreating" value="true" />
	</bean>

    <bean id="attorneys.registryIndividualNumber" parent="fillUtilityNumberField">
        <property name="className" value="attdl:attorneys" />
        <property name="stringField" value="attdl:registryIndividualNumber" />
        <property name="numericField" value="attdl:registryIndividualNumberSort" />
    </bean>

    <bean id="attorneys.att_number" parent="fillUtilityNumberField">
        <property name="className" value="att:attorneyForm" />
        <property name="stringField" value="att:number" />
        <property name="numericField" value="att:numberSort" />
    </bean>

</beans>
