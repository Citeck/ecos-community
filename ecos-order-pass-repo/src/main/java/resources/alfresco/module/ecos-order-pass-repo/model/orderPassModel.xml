<?xml version="1.0" encoding="UTF-8"?>
<model name="att:att" xmlns="http://www.alfresco.org/model/dictionary/1.0">
    <description>Attorneys Form Model</description>
    <author>Citeck</author>
    <version>1.0</version>

    <imports>
        <import uri="http://www.alfresco.org/model/dictionary/1.0" prefix="d"/>
        <import uri="http://www.alfresco.org/model/content/1.0" prefix="cm"/>
        <import uri="http://www.alfresco.org/model/datalist/1.0" prefix="dl"/>
        <import uri="http://www.citeck.ru/model/content/dms/1.0" prefix="dms"/>
        <import uri="http://www.citeck.ru/model/content/classification/tk/1.0" prefix="tk"/>
        <import uri="http://www.citeck.ru/model/content/idocs/1.0" prefix="idocs"/>
        <import uri="http://www.citeck.ru/model/passport/1.0" prefix="pass"/>
        <import uri="http://www.citeck.ru/model/constraints/1.0" prefix="constraints"/>
    </imports>

    <namespaces>
        <namespace uri="http://www.citeck.ru/model/attorneys/common/1.0" prefix="att"/>
        <namespace uri="http://www.citeck.ru/model/attorneys/dl/1.0" prefix="attdl"/>
    </namespaces>

    <constraints>
        <constraint name="att:constraint:contractStatuses" type="LIST">
            <parameter name="allowedValues">
                <list>
                    <!-- Новая -->
                    <value>new</value>
                    <!-- На согласовании -->
                    <value>on-agreement</value>
                    <!-- На доработке -->
                    <value>on-rework</value>
                    <!-- Согласовано -->
                    <value>agreed</value>
                    <!-- Отказано -->
                    <value>cancelled</value>
                    <!-- Неактуально -->
                    <value>irrelevant</value>
                    <!-- На подписании -->
                    <value>on-signing</value>
                    <!-- Подписано ГД -->
                    <value>signed</value>
                    <!-- Передано инициатору -->
                    <value>toInitiator</value>
                    <!-- Отправлено в филиал -->
                    <value>toBranch</value>
                    <!-- Утверждена -->
                    <value>approved</value>
                    <!-- В Дело/Архив -->
                    <value>archived</value>
                </list>
            </parameter>
        </constraint>
        <constraint name="att:constraint:attorneyType" type="LIST">
            <parameter name="allowedValues">
                <list>
                    <value>standart</value>
                    <value>non-standart</value>
                    <value>notary</value>
                </list>
            </parameter>
        </constraint>
    </constraints>

    <types>
<!--         <type name="attdl:address"> -->
<!--             <title>Адрес</title> -->
<!--             <parent>dl:dataListItem</parent> -->
<!--             <properties> -->
<!--                 <property name="attdl:country"> -->
<!--                     <type>d:text</type> -->
<!--                 </property> -->
<!--                 <property name="attdl:city"> -->
<!--                     <type>d:text</type> -->
<!--                 </property> -->
<!--                 <property name="attdl:postIndex"> -->
<!--                     <type>d:text</type> -->
<!--                 </property> -->
<!--                 <property name="attdl:streetName"> -->
<!--                     <type>d:text</type> -->
<!--                 </property> -->
<!--                 <property name="attdl:houseNumber"> -->
<!--                     <type>d:text</type> -->
<!--                 </property> -->
<!--                 <property name="attdl:officeNumber"> -->
<!--                     <type>d:text</type> -->
<!--                 </property> -->
<!--             </properties> -->
<!--         </type> -->

        <type name="attdl:privilege">
            <title>Полномочия</title>
            <parent>dl:dataListItem</parent>
            <properties>
                <property name="attdl:privilegeCode">
                    <title>Код полномочия</title>
                    <type>d:text</type>
                    <mandatory>false</mandatory>
                </property>
                <property name="attdl:privilegeShortName">
                    <title>Краткое наименование полномочия</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                </property>
                <property name="attdl:privilegeName">
                    <title>Полное наименование полномочия</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                </property>
                <property name="attdl:optionalConfirm">
                    <title>Согласование необязательно</title>
                    <type>d:boolean</type>
                    <default>false</default>
                </property>
            </properties>
        </type>

        <type name="attdl:attorneys">
            <title>Доверенное лицо</title>
            <parent>dl:dataListItem</parent>
            <properties>
                <property name="attdl:isDraft">
                    <title>Черновик</title>
                    <type>d:boolean</type>
                    <default>false</default>
                </property>
                <property name="attdl:registryIndividualNumber">
                    <title>Учетный индивидуальный номер</title>
                    <type>d:text</type>
                    <mandatory>true</mandatory>
                </property>
                <property name="attdl:registryIndividualNumberSort">
                    <type>d:long</type>
                </property>
            </properties>
            <associations>
                <!-- deprecated -->
                <child-association name="attdl:passportScan">
                    <title>Скан-копия паспорта</title>
                    <source>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </source>
                    <target>
                        <class>cm:content</class>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </target>
                </child-association>
            </associations>
            <mandatory-aspects>
                <aspect>attdl:hasAttorneyPeople</aspect>
            </mandatory-aspects>
        </type>

        <type name="att:attorneyForm">
            <title>Доверенность</title>
            <parent>idocs:doc</parent>
            <properties>
                <property name="att:status">
                    <title>Текущее состояние</title>
                    <type>d:text</type>
                    <default>new</default>
                    <constraints>
                        <constraint ref="att:constraint:contractStatuses"/>
                    </constraints>
                </property>
                <property name="att:number">
                    <title>Номер заявки</title>
                    <type>d:text</type>
                </property>
                <property name="att:numberSort">
                    <type>d:long</type>
                </property>
                <property name="att:requestedPrivileges">
                    <title>Запрос на полномочия</title>
                    <type>d:text</type>
                </property>
                <property name="att:startDate">
                    <title>Дата начала действия доверенности</title>
                    <type>d:date</type>
                </property>
                <property name="att:endDate">
                    <title>Дата окончания действия доверенности</title>
                    <type>d:date</type>
                </property>
                <property name="att:cancell">
                    <title>Отмена доверенности</title>
                    <type>d:boolean</type>
                </property>
                <property name="att:cancellationDate">
                    <title>Дата отзыва доверенности</title>
                    <type>d:date</type>
                </property>
                <property name="att:isContractorForm">
                    <title>Доверенность по форме контрагента</title>
                    <type>d:boolean</type>
                </property>
                <property name="att:isInitiatorResponsibility">
                    <title>Признак «Под ответственность инициатора»</title>
                    <type>d:boolean</type>
                </property>
                <property name="att:comment">
                    <title>Примечание</title>
                    <type>d:text</type>
                </property>
                <property name="att:isChefAcccountant">
                    <title>Подпись главного бухгалтера</title>
                    <type>d:boolean</type>
                    <mandatory>false</mandatory>
                </property>
                <property name="att:allPassportsPresent">
                	<title>Все паспорта прикреплены</title>
                	<type>d:boolean</type>
                	<default>true</default>
                	<constraints>
                		<constraint ref="constraints:true" />
                	</constraints>
                </property>
                <property name="att:amount">
                    <title>Сумма</title>
                    <type>d:float</type>
                </property>
                <property name="att:isSentToCompany">
                    <title>Документ отправлен в филиал</title>
                    <type>d:boolean</type>
                </property>
                <property name="att:isOriginalReceived">
                    <title>Оригинал получен</title>
                    <type>d:boolean</type>
                </property>
                <property name="att:isScanCopyAttached">
                    <title>Скан-копия прикреплена</title>
                    <type>d:boolean</type>
                </property>
            </properties>
            <associations>
                <association name="att:organization">
                    <title>Наименование организации</title>
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>idocs:legalEntity</class>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </target>
                </association>
                <association name="att:privilege">
                    <title>Полномочия</title>
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>attdl:privilege</class>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </target>
                </association>
                <association name="att:principal">
                    <title>Доверенность выдана в лице</title>
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>cm:person</class>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </target>
                </association>
                <association name="att:attorney">
                    <title>Кому выдана доверенность</title>
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>attdl:attorneys</class>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </target>
                </association>
                <association name="att:attorneyPassports">
                    <title>Паспортные данные</title>
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>pass:passport</class>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </target>
                </association>
                <association name="att:implementer">
                    <title>Исполнитель</title>
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>cm:person</class>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </target>
                </association>
                <association name="att:currency">
                    <title>Валюта</title>
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>idocs:currency</class>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </target>
                </association>
                <association name="att:assocBranch">
                    <title>Филиал</title>
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>cm:authorityContainer</class>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </target>
                </association>
            </associations>

            <mandatory-aspects>
                <aspect>att:hasNotaryAttorney</aspect>
                <aspect>att:hasRegistrationDate</aspect>
                <aspect>att:originalInfo</aspect>
                <aspect>att:hasInitiator</aspect>

                <aspect>dms:templateable</aspect>
                <aspect>dms:hasSupplementaryFiles</aspect>
                <aspect>tk:documentTypeKind</aspect>
                <aspect>attdl:hasAttorneyPeople</aspect>
                <aspect>idocs:lifeCycle</aspect>
            </mandatory-aspects>
        </type>
    </types>

    <aspects>
    
    	<aspect name="attdl:hasAttorneyPeople">
			<associations>    	
                <association name="attdl:attorneyPerson">
                    <title>Сотрудник(и)</title>
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>cm:person</class>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </target>
                </association>
	    	</associations>
    	</aspect>
    
        <aspect name="att:passportData">
            <title>Паспортные данные</title>
            <properties>
                <property name="att:passportSeries">
                    <title>Серия паспорта</title>
                    <type>d:text</type>
                    <mandatory>false</mandatory>
                    <constraints>
                        <constraint ref="pass:constraint:numbersOnly"/>
                    </constraints>
                </property>
                <property name="att:passportNumber">
                    <title>Номер паспорта</title>
                    <type>d:text</type>
                    <mandatory>false</mandatory>
                    <constraints>
                        <constraint ref="pass:constraint:numbersOnly"/>
                    </constraints>
                </property>
                <property name="att:issueDate">
                    <title>Дата выдачи</title>
                    <type>d:date</type>
                    <mandatory>false</mandatory>
                </property>
                <property name="att:issuingAuthority">
                    <title>Кем выдан паспорт</title>
                    <type>d:text</type>
                    <mandatory>false</mandatory>
                </property>
                <property name="att:subdivisionCode">
                    <title>Код подразделения</title>
                    <type>d:text</type>
                    <mandatory>false</mandatory>
                </property>
            </properties>
        </aspect>

        <aspect name="att:sentToBranch">
            <properties>
                <property name="att:invoiceCode">
                    <title>Код накладной (при отправке в филиал)</title>
                    <type>d:text</type>
                </property>
                <property name="att:invoiceDate">
                    <title>Дата отправки в филиал</title>
                    <type>d:date</type>
                </property>
                <property name="att:invoiced">
                    <title>Отправлено в филиал</title>
                    <type>d:boolean</type>
                    <default>false</default>
                </property>
                <property name="att:backInvoiceCode">
                    <title>Код накладной (при отправке из филиала)</title>
                    <type>d:text</type>
                </property>
                <property name="att:backInvoiceDate">
                    <title>Дата отправки из филиала</title>
                    <type>d:date</type>
                </property>
                <property name="att:backInvoiced">
                    <title>Отправлено из филиала</title>
                    <type>d:boolean</type>
                    <default>false</default>
                </property>
            </properties>
        </aspect>

        <aspect name="att:hasLastComment">
            <properties>
                <property name="att:lastComment">
                    <title>Последний комментарий</title>
                    <type>d:text</type>
                </property>
            </properties>
        </aspect>

        <aspect name="att:hasResponsibleEmployee">
            <properties>
                <property name="att:responsibleEmployee">
                    <title>Ответственный</title>
                    <type>d:text</type>
                </property>
            </properties>
        </aspect>

        <aspect name="att:hasNotaryAttorney">
            <properties>
                <property name="att:notaryAttorney">
                    <title>Нотариальная доверенность</title>
                    <type>d:boolean</type>
                </property>
            </properties>
        </aspect>
        <aspect name="att:hasRegistrationDate">
            <properties>
                <property name="att:registrationDate">
                    <title>Дата регистрации</title>
                    <type>d:date</type>
                </property>
            </properties>
        </aspect>
        <aspect name="att:originalInfo">
            <properties>
                <property name="att:needOriginal">
                    <title>Нужен оригинал</title>
                    <type>d:boolean</type>
                </property>
                <property name="att:amountOriginal">
                    <title>Количество оригиналов</title>
                    <type>d:int</type>
                </property>
                <property name="att:shippingAddress">
                    <title>Адрес доставки оригиналов</title>
                    <type>d:text</type>
                </property>
                <property name="att:commentAddress">
                    <title>Комментарий к адресу доставки</title>
                    <type>d:text</type>
                </property>
            </properties>
            <associations>
                <association name="att:originalsRecipient">
                    <title>Получатель оригиналов</title>
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>cm:person</class>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </target>
                </association>
            </associations>
        </aspect>

        <aspect name="att:hasAttorneyType">
            <properties>
                <property name="att:attorneyType">
                    <title>Тип доверенности</title>
                    <type>d:text</type>
                    <default>Standart</default>
                    <constraints>
                        <constraint ref="att:constraint:attorneyType" />
                    </constraints>
                </property>
            </properties>
        </aspect>

        <aspect name="att:hasInitiator">
            <associations>
                <association name="att:initiator">
                    <title>Инициатор</title>
                    <source>
                        <mandatory>false</mandatory>
                        <many>true</many>
                    </source>
                    <target>
                        <class>cm:person</class>
                        <mandatory>false</mandatory>
                        <many>false</many>
                    </target>
                </association>
            </associations>
        </aspect>

    </aspects>

</model>
