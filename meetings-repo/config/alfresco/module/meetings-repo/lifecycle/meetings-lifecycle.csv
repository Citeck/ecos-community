fromState,event,toState,transitionCondition,action
start,"{""eventType"":""automaticTransition""}",project,,document.properties['idocs:documentStatus'] = 'new'; document.save();
project,"{""eventType"":""userTransition"",""actionName"":""Создать повестку совещания"",""urlId"":""create-content?itemId=meet:agenda&formId=&destination={nodeRef}""}",project,document.properties.creator == person.properties.userName && !document.childAssocs['meet:childAgenda'],
project,"{""eventType"":""onStartProcess"",""workflowId"":""activiti$familiarization"",""actionName"":""Рассылка на ознакомление"",""formId"":""meetings""}",onFamiliarization,(document.properties.creator == person.properties.userName && document.childAssocs['meet:childAgenda'] && document.childAssocs['meet:childAgenda'].length>0),document.properties['idocs:documentStatus'] = 'onFamiliarization'; document.save();
onFamiliarization,"{""eventType"":""onEndProcess"",""workflowId"":""activiti$familiarization""}",familiarized,,"document.properties['idocs:documentStatus'] = 'familiarized'; document.save();"
onFamiliarization,"{""eventType"":""timerTransition"",""dateTimeExpression"":""var cal = java.util.Calendar.getInstance();cal.setTime(document.properties['meet:when']);cal.getTime();""}",conducted,,"var tasks = getTaskForWorkflow(""activiti$familiarization""); for(var i=0; i<tasks.length;i++){if(tasks[i]) {completeTask(tasks[i], ""CompletedBySystem"");}} document.properties['idocs:documentStatus'] = 'conducted'; document.save();"
familiarized,"{""eventType"":""timerTransition"",""dateTimeExpression"":""var cal = java.util.Calendar.getInstance();cal.setTime(document.properties['meet:when']);cal.getTime();""}",conducted,,"document.properties['idocs:documentStatus'] = 'conducted'; document.save();"
conducted,"{""eventType"":""userTransition"",""actionName"":""Создать протокол совещания"",""urlId"":""create-content?itemId=meet:protocol&formId=&destination={nodeRef}""}",conducted,document.properties.creator == person.properties.userName && !document.childAssocs['meet:childProtocol'],
conducted,"{""eventType"":""onStartProcess"",""workflowId"":""activiti$confirm"",""actionName"":""confirm"",""formId"":""meetings""}",onConfirm,(document.properties.creator == person.properties.userName && document.childAssocs['meet:childProtocol'] && document.childAssocs['meet:childProtocol'].length>0),document.properties['idocs:documentStatus'] = 'onConfirm'; document.properties['meet:confirmDueDate'] = process.bpm_workflowDueDate; document.save(); process.wfcf_skipCorrectTask = true; process.wfcf_confirmersPermission = 'Collaborator';
onConfirm,"{""eventType"":""onEndProcess"",""workflowId"":""activiti$confirm""}",confirmed,,"document.properties['idocs:documentStatus'] = 'approved'; document.childAssocs['meet:childProtocol'][0].properties['idocs:documentStatus'] = 'approved'; document.childAssocs['meet:childProtocol'][0].save(); document.save();"
onConfirm,"{""eventType"":""timerTransition"",""dateTimeExpression"":""var cal = java.util.Calendar.getInstance();cal.setTime(document.properties['meet:confirmDueDate']);cal.getTime();""}",confirmed,,"var tasks = getTaskForWorkflow(""activiti$confirm""); for(var i=0; i<tasks.length;i++){if(tasks[i]) {completeTask(tasks[i], ""CompletedBySystem"");}} document.properties['idocs:documentStatus'] = 'approved'; document.childAssocs['meet:childProtocol'][0].properties['idocs:documentStatus'] = 'approved'; document.childAssocs['meet:childProtocol'][0].save(); document.save();"
confirmed,"{""eventType"":""automaticTransition""}",onPerformance,getActiveWorkflows('activiti$perform').length > 0,document.properties['idocs:documentStatus'] = 'onPerformance'; document.save();
onPerformance,"{""eventType"":""onEndProcess"",""workflowId"":""activiti$perform""}",performed,"(getActiveWorkflows(""activiti$perform"").length == 1 && getActiveWorkflows(""activiti$familiarization"").length == 0)","document.properties['idocs:documentStatus'] = 'performed'; document.save(); document.childAssocs['meet:childProtocol'][0].properties['idocs:documentStatus'] = 'performed'; document.childAssocs['meet:childProtocol'][0].save();"
onPerformance,"{""eventType"":""onEndProcess"",""workflowId"":""activiti$familiarization""}",performed,"(getActiveWorkflows(""activiti$perform"").length == 0 && getActiveWorkflows(""activiti$familiarization"").length == 1)","document.properties['idocs:documentStatus'] = 'performed'; document.save(); document.childAssocs['meet:childProtocol'][0].properties['idocs:documentStatus'] = 'performed'; document.childAssocs['meet:childProtocol'][0].save();"
performed,"{""eventType"":""userTransition"",""actionName"":""Закрыть кейс""}",closed,document.properties.creator == person.properties.userName && getActiveWorkflows('activiti$perform').length == 0 && getActiveWorkflows('activiti$familiarization').length == 0,"document.properties['idocs:documentStatus'] = 'closed'; document.save();"
